#!/usr/bin/perl
use strict;
use warnings;

my $dir = "$ENV{HOME}/Code/n9";
my $dest = "$dir/backup";
my $contactsSrcDir = "/home/user/MyDocs/backup-contacts";
my $contactsDestDir = "$dest/backup-contacts";

sub run(@);

sub main(@){
  my $host = `n9`;
  chomp $host;

  run "n9", "-s", "backup-contacts";
  run "mkdir", "-p", $contactsDestDir;
  run "rsync", "-avP", "root\@$host:$contactsSrcDir/", $contactsDestDir;
}

sub run(@){
  print "@_\n";
  system @_;
  die "FAILED: @_\n" if $? != 0;
}

&main(@ARGV);
